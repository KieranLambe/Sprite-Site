<div class="content-padding">
  <div class="welcome-container d-flex">
    <!-- Left column for the new can and text -->
    <div class="left-column d-flex flex-column align-items-center">
      <div class="welcome-text-container text-center">
        <h3>When life gives you</h3>
        <h2>Lemons</h2>
      </div>
      <div class="image-container" data-controller="floating" data-floating-offset-value="40">
        <div id="sprite-container">
          <div data-floating-target="element" data-offset="40" class="floating-element">
            <%= image_tag 'new-sprite-can.png', alt: 'New Sprite Can', style: 'transform: rotate(-20deg); max-width: 200px;' %>
          </div>
        </div>
      </div>
    </div>

    <!-- Center column for the lemon -->
    <div class="center-column d-flex justify-content-center align-items-center">
      <div class="lemon-container">
        <div class="lemon">
            <div class="lemon-text text-center">
            <h4>In 1961 we took</h4>
            <h4 style="font-style: italic;">sour</h4>
            <h4 style="font-weight: bold;">lemons</h4>
            <h4>and made:</h4>
          </div>
        </div>
      </div>
    </div>

    <!-- Right column for the old can -->
    <div class="right-column d-flex justify-content-center align-items-center" data-controller="floating" data-floating-offset-value="-40">
      <div id="sprite-container">
        <div data-floating-target="element" data-offset="20" class="floating-element">
          <%= image_tag 'sprite-can-classic.png', alt: 'Sprite Can', style: 'transform: rotate(20deg); max-width: 250px;' %>
        </div>
      </div>
    </div>
  </div>
</div>



<div class="content-padding">
  <span><h3>Browse our</h3></span>
  <span><h2>Unique</h2></span>
  <span><h3>thirst solutions:</h3></span>
</div>
<div class="container mt-4">
  <div class="row">
    <% @items.each_with_index do |item, index| %>
      <div class="col-md-4 mb-4">
        <div class="card bg-black text-white">
          <% if item.image_filename.present? %>
            <div class="card-image-container">
              <%= image_tag "items/#{item.image_filename}", class: "card-img-top" %>
            </div>
          <% else %>
            <div class="card-image-container">
              <%= image_tag 'default_image.png', class: "card-img-top" %> <!-- Default image if none attached -->
            </div>
          <% end %>
          <div class="card-body">
            <h5 class="card-title"><%= item.name %></h5>
            <p class="card-text"><%= item.description %></p>
            <p class="card-text"><%= number_to_currency(item.price) %></p>
            <p class="card-text">Star Rating: <%= item.star_rating %></p>
            <%= form_with url: basket_add_to_basket_path(@basket.token), method: :post, local: true do %>
              <%= hidden_field_tag :item_id, item.id %>
              <div class="quantity-adjuster">
                <%= button_tag(type: 'button', class: 'btn btn-secondary', onclick: "changeQuantity(this, -1)") do %>
                  -
                <% end %>
                <span class="quantity-display">1</span>
                <%= button_tag(type: 'button', class: 'btn btn-secondary', onclick: "changeQuantity(this, 1)") do %>
                  +
                <% end %>
              </div>
              <%= hidden_field_tag :quantity, 1, id: "quantity-#{item.id}" %>
              <%= submit_tag "Add to Basket", class: "btn btn-primary" %>
            <% end %>
            <script>
              function changeQuantity(button, change) {
                const form = button.closest('form');
                const quantityInput = form.querySelector(`input[type="hidden"][name="quantity"]`);
                const quantityDisplay = form.querySelector('.quantity-display');
                let quantity = parseInt(quantityInput.value) + change;
                if (quantity < 1) {
                  quantity = 1;
                }
                quantityInput.value = quantity;
                quantityDisplay.textContent = quantity;
              }
            </script>
          </div>
        </div>
      </div>
      <% if (index + 1) % 3 == 0 %>
        </div><div class="row">
      <% end %>
    <% end %>
  </div>
</div>
